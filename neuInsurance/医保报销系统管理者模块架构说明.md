# 医保报销系统管理者模块架构说明

## 系统概述

本系统是一个基于Spring Boot的医保报销管理系统，主要用于管理医保报销相关的业务流程。系统采用分层架构设计，包含管理员权限管理、药品管理、患者管理、结算管理和报销等级配置等核心功能模块。

## 系统架构

### 1. 技术栈
- **后端框架**: Spring Boot 2.x
- **数据库**: MySQL 8.0+
- **ORM框架**: MyBatis
- **项目管理**: Maven
- **开发工具**: Lombok（简化代码）

### 2. 模块结构

```
src/main/java/org/neu/insurance/
├── controller/          # 控制器层
├── service/            # 业务逻辑层
├── service/impl/       # 业务实现层
├── entity/             # 实体类
├── dto/                # 数据传输对象
├── mapper/             # 数据访问层接口
├── config/             # 配置类
├── util/               # 工具类
└── vo/                 # 视图对象

src/main/resources/
├── mapper/             # MyBatis映射文件
├── sql/                # 数据库脚本
└── application.yml     # 配置文件
```

## 核心功能模块

### 1. 管理员权限管理模块

#### 实体类
- **Admin**: 管理员实体，包含用户名、密码、个人信息等
- **Role**: 角色实体，定义系统角色
- **Permission**: 权限实体，定义系统权限
- **Department**: 部门实体，管理组织架构

#### 主要功能
- 管理员的增删改查
- 角色管理和权限分配
- 登录认证和会话管理
- 密码管理（重置、修改）
- 账户锁定/解锁机制

#### 控制器
- `AdminController`: 管理员管理接口
- `RoleController`: 角色管理接口
- `PermissionController`: 权限管理接口

### 2. 报销等级配置模块

#### 实体类
- **ReimbursementLevel**: 报销等级配置，定义不同医保类型和医院等级的报销标准

#### 主要功能
- 报销等级的增删改查
- 根据医保类型和医院等级匹配报销标准
- 报销比例配置（甲类、乙类、丙类药品）
- 起付线和封顶线设置
- 配置的有效期管理

#### 控制器
- `ReimbursementLevelController`: 报销等级配置接口

### 3. 业务管理模块

#### 实体类
- **Drug**: 药品实体，药品目录管理
- **Patient**: 患者实体，患者信息管理
- **Settlement**: 结算实体，医保结算记录
- **Hospital**: 医院实体，医院信息管理
- **MedicalOrder**: 医疗订单，就诊记录
- **MedicalOrderItem**: 医疗订单明细

#### 主要功能
- 药品目录管理
- 患者信息管理
- 医疗结算处理
- 医院信息维护

## 数据库设计

### 核心表结构

1. **系统管理相关表**
   - `sys_admin`: 管理员表
   - `sys_role`: 角色表
   - `sys_permission`: 权限表
   - `sys_department`: 部门表
   - `sys_admin_role`: 管理员角色关联表
   - `sys_role_permission`: 角色权限关联表

2. **业务相关表**
   - `reimbursement_level`: 报销等级配置表
   - `hospital`: 医院表
   - `drug`: 药品表
   - `patient`: 患者表
   - `settlement`: 结算表
   - `medical_order`: 医疗订单表
   - `medical_order_item`: 医疗订单明细表

### 数据库特性
- 支持事务处理
- 建立了合适的索引优化查询性能
- 使用外键约束保证数据完整性
- 支持软删除（状态字段）
- 创建时间和更新时间自动维护

## API 设计

### 1. 统一响应格式
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {}
}
```

### 2. 分页查询格式
```json
{
  "records": [],
  "total": 100,
  "pageNum": 1,
  "pageSize": 10,
  "totalPages": 10
}
```

### 3. 主要接口说明

#### 管理员管理
- `GET /api/admin/list`: 分页查询管理员列表
- `POST /api/admin`: 新增管理员
- `PUT /api/admin/{id}`: 更新管理员信息
- `DELETE /api/admin/{id}`: 删除管理员
- `POST /api/admin/login`: 管理员登录
- `POST /api/admin/logout`: 管理员登出

#### 报销等级配置
- `GET /api/reimbursement-level/list`: 分页查询报销等级
- `POST /api/reimbursement-level`: 新增报销等级
- `PUT /api/reimbursement-level/{id}`: 更新报销等级
- `GET /api/reimbursement-level/match`: 匹配报销等级

## 安全设计

### 1. 认证授权
- 基于token的认证机制
- 角色基础的访问控制(RBAC)
- 接口级别的权限控制

### 2. 数据安全
- 密码加密存储
- 敏感数据脱敏
- 操作日志记录

### 3. 防护机制
- 登录失败锁定
- 会话超时控制
- 跨域请求控制

## 扩展性设计

### 1. 服务层抽象
- 定义清晰的服务接口
- 实现类可替换
- 支持多种数据源

### 2. 配置管理
- 外部化配置
- 环境隔离
- 动态配置刷新

### 3. 监控和日志
- 操作日志记录
- 性能监控
- 异常监控

## 部署说明

### 1. 环境要求
- JDK 1.8+
- MySQL 8.0+
- Maven 3.6+

### 2. 部署步骤
1. 创建数据库并执行初始化脚本
2. 修改配置文件中的数据库连接信息
3. 执行 `mvn clean package` 构建项目
4. 运行 `java -jar target/neu-insurance-1.0.0.jar` 启动应用

### 3. 默认账号
- 超级管理员：admin/123456
- 业务管理员：manager/123456

## 后续开发建议

1. **完善业务逻辑实现**: 目前控制器和服务层方法都是骨架，需要根据具体业务需求实现
2. **添加数据验证**: 在实体类和DTO中添加数据验证注解
3. **集成安全框架**: 建议集成Spring Security或Apache Shiro
4. **添加缓存**: 使用Redis等缓存组件提升性能
5. **完善异常处理**: 统一异常处理机制
6. **添加单元测试**: 为关键业务逻辑编写单元测试
7. **API文档**: 使用Swagger生成API文档
8. **性能优化**: 数据库查询优化、分页优化等 